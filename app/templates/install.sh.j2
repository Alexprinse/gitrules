#!/bin/bash
# Gitrules Installation Script
# Generated: {{ timestamp }}

echo "  ____ _ _   ____        _           "
echo " / ___(_) |_|  _ \\ _   _| | ___  ___ "
echo "| |  _| | __| |_) | | | | |/ _ \\/ __|"
echo "| |_| | | |_|  _ <| |_| | |  __/\\__ \\"
echo " \\____|_|\\__|_| \\_\\\\__,_|_|\\___||___/ "

echo ""

echo "This script will create/modify the following files:"
echo ""
{% for path in files -%}
echo "  - {{ path }}"
{% endfor -%}
echo ""
echo "Total files: {{ files|length }}"
echo ""
if [ -t 0 ]; then
    printf "Do you want to proceed? (Y/n): "
    read REPLY
    if [ "$REPLY" != "Y" ] && [ "$REPLY" != "y" ] && [ -n "$REPLY" ]; then
        echo "Installation cancelled."
        exit 1
    fi
else
    echo "Running in non-interactive mode, proceeding automatically..."
    echo ""
fi

echo ""
echo "Creating files..."
echo ""

# Create necessary directories
{% for dir in directories -%}
mkdir -p "{{ dir }}"
{% endfor -%}

{% for path, content in files.items() -%}
# Creating {{ path }}
cat > "{{ path }}" << 'GITRULES_EOF'
{{ content|safe }}{% if not content.endswith('\n') %}
{% endif %}GITRULES_EOF

{% endfor -%}
echo "Installation complete!"
echo ""
echo "Files have been created in your current directory."
{% if env_vars %}
echo ""
echo "⚠️  Environment Variables Required:"
{% for env_var in env_vars %}
echo "  - {{ env_var }}"
{% endfor %}
{% endif %}
echo ""