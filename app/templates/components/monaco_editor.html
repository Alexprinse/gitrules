<div class="card">
    <div class="card-inner bg-[#fafafa] p-6">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-lg font-bold text-gray-900">Context Editor</h3>
            <div class="flex gap-2">
                <button id="copy-editor-content" 
                        class="px-4 py-2 bg-[#ffc480] border-[3px] border-gray-900 text-gray-900 hover:-translate-y-px hover:-translate-x-px transition-transform relative z-10 flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                    </svg>
                    Copy
                </button>
                <div class="relative">
                    <select id="language-select" 
                            class="px-4 py-2 bg-white border-[3px] border-gray-900 text-gray-900 focus:outline-none appearance-none pr-8">
                        <option value="javascript">JavaScript</option>
                        <option value="typescript">TypeScript</option>
                        <option value="python">Python</option>
                        <option value="json">JSON</option>
                        <option value="yaml">YAML</option>
                        <option value="markdown">Markdown</option>
                        <option value="html">HTML</option>
                        <option value="css">CSS</option>
                        <option value="sql">SQL</option>
                        <option value="shell">Shell</option>
                    </select>
                    <svg class="absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 pointer-events-none" 
                         fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <polyline points="6 9 12 15 18 9" />
                    </svg>
                </div>
            </div>
        </div>
        
        <div class="relative">
            <div class="w-full h-full bg-gray-900 translate-y-1 translate-x-1 absolute inset-0"></div>
            <div id="monaco-editor" 
                 class="relative z-10 border-[3px] border-gray-900" 
                 style="height: 400px;"></div>
        </div>
        
    </div>
</div>

<!-- Monaco Editor CDN -->
<script src="https://unpkg.com/monaco-editor@0.44.0/min/vs/loader.js"></script>
<script>
let monacoEditor;

require.config({ paths: { vs: 'https://unpkg.com/monaco-editor@0.44.0/min/vs' } });

require(['vs/editor/editor.main'], function () {
    monacoEditor = monaco.editor.create(document.getElementById('monaco-editor'), {
        value: `// Welcome to the Context Editor!
// This is a fully-featured Monaco Editor with syntax highlighting

function generateRules(repository) {
    const rules = {
        name: repository.name,
        type: 'automation',
        triggers: ['push', 'pull_request'],
        actions: []
    };
    
    return rules;
}

// Try changing the language from the dropdown above
console.log('Monaco Editor is ready!');`,
        language: 'javascript',
        theme: 'vs',
        fontSize: 14,
        lineNumbers: 'on',
        minimap: { enabled: false },
        scrollBeyondLastLine: false,
        automaticLayout: true,
        wordWrap: 'on',
        fontFamily: 'Consolas, "Courier New", monospace'
    });

    // Language change handler
    document.getElementById('language-select').addEventListener('change', function(e) {
        const language = e.target.value;
        monaco.editor.setModelLanguage(monacoEditor.getModel(), language);
        
        // Set sample content based on language
        const samples = {
            javascript: `// JavaScript example
function processRepository(repo) {
    return {
        name: repo.name,
        rules: generateRules(repo)
    };
}`,
            typescript: `// TypeScript example
interface Repository {
    name: string;
    url: string;
}

function processRepository(repo: Repository): object {
    return {
        name: repo.name,
        rules: generateRules(repo)
    };
}`,
            python: `# Python example
def process_repository(repo):
    """Process a repository and generate rules."""
    return {
        'name': repo['name'],
        'rules': generate_rules(repo)
    }

class RuleGenerator:
    def __init__(self, repo):
        self.repo = repo`,
            json: `{
  "name": "example-rules",
  "version": "1.0.0",
  "rules": [
    {
      "trigger": "push",
      "action": "validate",
      "patterns": ["*.js", "*.ts"]
    }
  ]
}`,
            yaml: `# YAML configuration
name: example-rules
version: 1.0.0
rules:
  - trigger: push
    action: validate
    patterns:
      - "*.js"
      - "*.ts"
  - trigger: pull_request
    action: review`,
            markdown: `# Repository Rules

## Overview
This document describes the automated rules for this repository.

## Rules

### Code Quality
- All code must pass linting
- Tests are required for new features

### Workflow
- Pull requests require review
- Main branch is protected`,
            html: `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Repository Rules</title>
</head>
<body>
    <h1>Repository Configuration</h1>
    <div class="rules-container">
        <!-- Rules will be inserted here -->
    </div>
</body>
</html>`,
            css: `/* Repository styling rules */
.repository-rules {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
}

.rule-item {
    border: 1px solid #ddd;
    border-radius: 4px;
    margin-bottom: 10px;
    padding: 15px;
}

.rule-trigger {
    font-weight: bold;
    color: #333;
}`,
            sql: `-- Repository rules database schema
CREATE TABLE repository_rules (
    id INTEGER PRIMARY KEY,
    repository_name VARCHAR(255) NOT NULL,
    rule_type VARCHAR(100),
    trigger_event VARCHAR(100),
    action_config TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO repository_rules (repository_name, rule_type, trigger_event)
VALUES ('example-repo', 'validation', 'push');`,
            shell: `#!/bin/bash
# Repository automation script

REPO_NAME="$1"
RULE_TYPE="$2"

generate_rules() {
    echo "Generating rules for repository: $REPO_NAME"
    echo "Rule type: $RULE_TYPE"
    
    # Add your rule generation logic here
    case "$RULE_TYPE" in
        "validation")
            echo "Setting up validation rules..."
            ;;
        "deployment")
            echo "Setting up deployment rules..."
            ;;
    esac
}

generate_rules`
        };
        
        if (samples[language]) {
            monacoEditor.setValue(samples[language]);
        }
    });

    // Copy functionality
    document.getElementById('copy-editor-content').addEventListener('click', function() {
        const content = monacoEditor.getValue();
        navigator.clipboard.writeText(content).then(function() {
            // Visual feedback
            const button = document.getElementById('copy-editor-content');
            const originalText = button.innerHTML;
            button.innerHTML = '<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>Copied!';
            setTimeout(() => {
                button.innerHTML = originalText;
            }, 2000);
        }).catch(function(err) {
            console.error('Failed to copy: ', err);
        });
    });
});
</script>